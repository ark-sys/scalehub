---
apiVersion: v1
kind: ConfigMap
metadata:
  name: mosquitto-configmaps
  namespace: experiment-monitor
  labels:
    app: mqtt-broker
data:
  mosquitto.conf: |+
      persistence true
      persistence_location /mosquitto/data/
      log_dest file /mosquitto/log/mosquitto.log
      log_dest stdout
      log_type all
      log_timestamp_format %Y-%m-%dT%H:%M:%S
      listener 1883
      allow_anonymous false
      password_file /mosquitto/config/passwd
      acl_file /mosquitto/config/acl
  acl: |+
    user monitor
    topic readwrite experiment/command
    topic write experiment/state
    topic write experiment/ack
    user scalehub
    topic write experiment/command
    topic read experiment/state
    topic read experiment/ack
  passwd: |+
    monitor:$7$101$3PPLPdVz0ZnJ3WAD$pV+diD/yR7HpPy/cRaCWCefFg216JzT4HpUwNgre6gS87Bn7qpnjr1WDWa6NoAjoEiKs61kbWJmVGNPRJY8dNQ==
    scalehub:$7$101$+a31V5NImh9bJ8ko$pGJrnLZlNz8lFS1T5VPKJat+1Jh89hH90r20D25OIivuZG8xMq+NA33qWsWUdBb39fyg6obbDMO2l+u3vmg46Q==
