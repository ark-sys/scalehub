[0m[2025-01-22T19:17:10.146791] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T19:17:11.999084] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T19:17:11.999145] [SCALING] Setting up experiment.


[0m[2025-01-22T19:17:11.999156] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T19:17:12.007256] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T19:17:12.022335] [SCALING] First node: paradoxe-4.rennes.grid5000.fr

[0m[2025-01-22T19:17:12.041134] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:17:12.053388] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 1 replica.
[0m[2025-01-22T19:17:17.062890] [FLK_MGR] Running job.
[0m[2025-01-22T19:17:17.400940] [POD_MGR] Running command ['/bin/sh', '-c', 'flink run -d -j /tmp/jobs/myjoin-transscale-all.jar'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:17:22.442725] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Job has been submitted with JobID abcfef45aa0bf04f6f361da3c6d2b4f8

[0m[2025-01-22T19:17:22.442926] [FLK_MGR] Running job id: abcfef45aa0bf04f6f361da3c6d2b4f8
[0m[2025-01-22T19:17:22.442942] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:17:22.463545] [FLK_MGR] Job plan response: {"plan":{"jid":"abcfef45aa0bf04f6f361da3c6d2b4f8","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"FORWARD","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":1,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:17:22.463713] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:17:22.800811] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:17:24.261033] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:17:21 : abcfef45aa0bf04f6f361da3c6d2b4f8 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:17:24.261176] [FLK_MGR] Running jobs: ['abcfef45aa0bf04f6f361da3c6d2b4f8']
[0m[2025-01-22T19:17:24.261186] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:17:24.261193] [SCALING] First iteration after setup, just waiting...
[0m[2025-01-22T19:21:24.285014] [SCALING] Scaling started.
[0m[2025-01-22T19:21:24.285120] [SCALING] Decrementing count of first TM by 1.

[0m[2025-01-22T19:21:24.285154] =========================================================== Step 0 ===========================================================
[0m[2025-01-22T19:21:24.285173] [SCALING] Scaling on node : grid5000
[0m[2025-01-22T19:21:24.285247] [SCALING] Adding 1 replicas of l-2c taskmanager.
[0m[2025-01-22T19:21:24.290408] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:21:24.300184] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 1, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:21:24.310369] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 2 replica.
[0m[2025-01-22T19:21:29.328414] [SCALING] ************************************ Adding 2 replicas ************************************
[0m[2025-01-22T19:21:29.328441] [FLK_MGR] Running job.
[0m[2025-01-22T19:21:29.328446] [FLK_MGR] Rescaling job to 2.
[0m[2025-01-22T19:21:29.610518] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d abcfef45aa0bf04f6f361da3c6d2b4f8'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:21:35.667857] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-abcfef-26d33b94ef58
[0m[2025-01-22T19:21:55.050165] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-abcfef-26d33b94ef58 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:21:58.092603] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 2.
[0m[2025-01-22T19:21:58.092642] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 2
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 70e210d82cef0ca49478224e48c213a5

[0m[2025-01-22T19:21:58.092668] [FLK_MGR] Running job id: 70e210d82cef0ca49478224e48c213a5
[0m[2025-01-22T19:21:58.092676] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:21:58.105004] [FLK_MGR] Job plan response: {"plan":{"jid":"70e210d82cef0ca49478224e48c213a5","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":2,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:21:58.105175] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:21:58.414772] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:21:59.801080] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:21:57 : 70e210d82cef0ca49478224e48c213a5 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:21:59.801136] [FLK_MGR] Running jobs: ['70e210d82cef0ca49478224e48c213a5']
[0m[2025-01-22T19:21:59.801143] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:21:59.808773] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:25:59.830928] [SCALING] Adding 2 replicas of l-2c taskmanager.
[0m[2025-01-22T19:25:59.836532] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:25:59.846559] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 2, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:25:59.856534] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 4 replica.
[0m[2025-01-22T19:26:04.874048] [SCALING] ************************************ Adding 4 replicas ************************************
[0m[2025-01-22T19:26:04.874077] [FLK_MGR] Running job.
[0m[2025-01-22T19:26:04.874082] [FLK_MGR] Rescaling job to 4.
[0m[2025-01-22T19:26:05.201915] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 70e210d82cef0ca49478224e48c213a5'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:26:09.259897] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-70e210-c5ec8f018ac8
[0m[2025-01-22T19:26:28.646835] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-70e210-c5ec8f018ac8 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:26:31.608634] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 4.
[0m[2025-01-22T19:26:31.608669] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 4
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID b18bd483c9bb35f3f9119c0fca9cf72f

[0m[2025-01-22T19:26:31.608686] [FLK_MGR] Running job id: b18bd483c9bb35f3f9119c0fca9cf72f
[0m[2025-01-22T19:26:31.608695] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:26:31.615732] [FLK_MGR] Job plan response: {"plan":{"jid":"b18bd483c9bb35f3f9119c0fca9cf72f","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":4,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:26:31.615882] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:26:31.913251] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:26:33.316803] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:26:31 : b18bd483c9bb35f3f9119c0fca9cf72f : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:26:33.316854] [FLK_MGR] Running jobs: ['b18bd483c9bb35f3f9119c0fca9cf72f']
[0m[2025-01-22T19:26:33.316861] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:26:33.323895] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:30:33.346291] [SCALING] Adding 4 replicas of l-2c taskmanager.
[0m[2025-01-22T19:30:33.352798] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:30:33.362959] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 4, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:30:33.372376] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 8 replica.
[0m[2025-01-22T19:30:38.389861] [SCALING] ************************************ Adding 8 replicas ************************************
[0m[2025-01-22T19:30:38.389886] [FLK_MGR] Running job.
[0m[2025-01-22T19:30:38.389891] [FLK_MGR] Rescaling job to 8.
[0m[2025-01-22T19:30:38.762745] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d b18bd483c9bb35f3f9119c0fca9cf72f'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:30:42.835968] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-b18bd4-cb161e00d6a0
[0m[2025-01-22T19:31:02.120193] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-b18bd4-cb161e00d6a0 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:31:05.024301] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 8.
[0m[2025-01-22T19:31:05.024341] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 8
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID dc0d4778b2851dd8aaa74bc7f49237d6

[0m[2025-01-22T19:31:05.024363] [FLK_MGR] Running job id: dc0d4778b2851dd8aaa74bc7f49237d6
[0m[2025-01-22T19:31:05.024386] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:31:05.030702] [FLK_MGR] Job plan response: {"plan":{"jid":"dc0d4778b2851dd8aaa74bc7f49237d6","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":8,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:31:05.030977] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:31:05.438881] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:31:06.870631] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:31:04 : dc0d4778b2851dd8aaa74bc7f49237d6 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:31:06.870686] [FLK_MGR] Running jobs: ['dc0d4778b2851dd8aaa74bc7f49237d6']
[0m[2025-01-22T19:31:06.870692] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:31:06.877539] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:35:06.901798] [SCALING] Adding 8 replicas of l-2c taskmanager.
[0m[2025-01-22T19:35:06.907907] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:35:06.918176] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 8, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:35:06.927827] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 16 replica.
[0m[2025-01-22T19:35:11.945636] [SCALING] ************************************ Adding 16 replicas ************************************
[0m[2025-01-22T19:35:11.945664] [FLK_MGR] Running job.
[0m[2025-01-22T19:35:11.945669] [FLK_MGR] Rescaling job to 16.
[0m[2025-01-22T19:35:12.348107] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d dc0d4778b2851dd8aaa74bc7f49237d6'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:35:16.409980] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-dc0d47-81139b7c2dcf
[0m[2025-01-22T19:35:35.717641] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-dc0d47-81139b7c2dcf -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:35:38.515784] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 16.
[0m[2025-01-22T19:35:38.515823] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 16
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID d26cbadaa171ef0393643022a5954d12

[0m[2025-01-22T19:35:38.515843] [FLK_MGR] Running job id: d26cbadaa171ef0393643022a5954d12
[0m[2025-01-22T19:35:38.515850] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:35:38.525669] [FLK_MGR] Job plan response: {"plan":{"jid":"d26cbadaa171ef0393643022a5954d12","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":16,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:35:38.525808] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:35:38.864207] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:35:40.344862] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:35:38 : d26cbadaa171ef0393643022a5954d12 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:35:40.344920] [FLK_MGR] Running jobs: ['d26cbadaa171ef0393643022a5954d12']
[0m[2025-01-22T19:35:40.344927] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:35:40.352568] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:39:40.376504] [SCALING] Adding 10 replicas of l-2c taskmanager.
[0m[2025-01-22T19:39:40.382207] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:39:40.392486] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 16, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:39:40.402220] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 26 replica.
[0m[2025-01-22T19:39:45.421136] [SCALING] ************************************ Adding 26 replicas ************************************
[0m[2025-01-22T19:39:45.421163] [FLK_MGR] Running job.
[0m[2025-01-22T19:39:45.421168] [FLK_MGR] Rescaling job to 26.
[0m[2025-01-22T19:39:45.808964] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d d26cbadaa171ef0393643022a5954d12'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:39:49.852367] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-d26cba-990defeacde3
[0m[2025-01-22T19:40:09.175521] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-d26cba-990defeacde3 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:40:11.978664] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 26.
[0m[2025-01-22T19:40:11.978711] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 26
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 15c384c755d8d8a1f3352ce927624895

[0m[2025-01-22T19:40:11.978733] [FLK_MGR] Running job id: 15c384c755d8d8a1f3352ce927624895
[0m[2025-01-22T19:40:11.978738] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:40:11.985826] [FLK_MGR] Job plan response: {"plan":{"jid":"15c384c755d8d8a1f3352ce927624895","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":26,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:40:11.985955] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:40:12.416600] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-kn5g8
[0m[2025-01-22T19:40:13.880789] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:40:11 : 15c384c755d8d8a1f3352ce927624895 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:40:13.880847] [FLK_MGR] Running jobs: ['15c384c755d8d8a1f3352ce927624895']
[0m[2025-01-22T19:40:13.880854] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:40:13.887731] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:44:13.911827] [SCALING] Scaling step on node paradoxe-4.rennes.grid5000.fr finished. Marking node as full.
[0m[2025-01-22T19:44:18.925029] [SCALING] Scaling finished.
[0m[2025-01-22T19:44:18.925108] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T19:44:18.940431] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T19:44:18.957309] [STS_MGR] Resetting taskmanagers.
[0m[2025-01-22T19:44:18.976536] [STS_MGR] StatefulSet flink-taskmanager-l scaled to 0 replica.
[0m[2025-01-22T19:44:18.988742] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 0 replica.
[0m[2025-01-22T19:44:24.008070] [STS_MGR] StatefulSet flink-taskmanager-m scaled to 0 replica.
[0m[2025-01-22T19:44:24.019472] [STS_MGR] StatefulSet flink-taskmanager-s scaled to 0 replica.
[0m[2025-01-22T19:44:24.030607] [STS_MGR] StatefulSet flink-taskmanager-xl scaled to 0 replica.
[0m[2025-01-22T19:44:24.041669] [STS_MGR] StatefulSet flink-taskmanager-xxl scaled to 0 replica.
[0m[2025-01-22T19:44:24.059149] [POD_MGR] Pod flink-jobmanager-7d7c784b74-kn5g8 deleted
[0m[2025-01-22T19:44:25.913522] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T19:44:27.822208] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T19:44:27.822291] Reloading playbook: application/kafka
[0m[2025-01-22T19:44:33.703778] Playbook /app/playbooks/application/kafka.yaml with tag delete executed successfully.
[0m[2025-01-22T19:45:39.660530] Playbook /app/playbooks/application/kafka.yaml with tag create executed successfully.
[0m[2025-01-22T19:45:39.660673] [EXPERIMENT] Run 1 completed. Start: 1737573428, End: 1737575139
[0m[2025-01-22T19:45:39.660680] [EXPERIMENT] Sleeping for 10 seconds before next run.
[0m[2025-01-22T19:45:49.661697] [EXPERIMENT] =================================== Starting run 2 ===================================
[0m[2025-01-22T19:45:51.509595] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T19:45:53.381973] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T19:45:53.382040] [SCALING] Setting up experiment.


[0m[2025-01-22T19:45:53.382053] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T19:45:53.386180] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T19:45:53.399312] [SCALING] First node: paradoxe-4.rennes.grid5000.fr

[0m[2025-01-22T19:45:53.415474] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:45:53.424622] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 1 replica.
[0m[2025-01-22T19:45:58.432976] [FLK_MGR] Running job.
[0m[2025-01-22T19:45:58.764564] [POD_MGR] Running command ['/bin/sh', '-c', 'flink run -d -j /tmp/jobs/myjoin-transscale-all.jar'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:46:02.816703] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Job has been submitted with JobID b7a8d3aadfebd719ef423ba0f19e4361

[0m[2025-01-22T19:46:02.816755] [FLK_MGR] Running job id: b7a8d3aadfebd719ef423ba0f19e4361
[0m[2025-01-22T19:46:02.816768] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:46:02.834856] [FLK_MGR] Job plan response: {"plan":{"jid":"b7a8d3aadfebd719ef423ba0f19e4361","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"FORWARD","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":1,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:46:02.835006] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:46:03.117426] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:46:04.568184] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:46:01 : b7a8d3aadfebd719ef423ba0f19e4361 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:46:04.568243] [FLK_MGR] Running jobs: ['b7a8d3aadfebd719ef423ba0f19e4361']
[0m[2025-01-22T19:46:04.568249] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:46:04.568257] [SCALING] First iteration after setup, just waiting...
[0m[2025-01-22T19:50:04.592225] [SCALING] Scaling started.
[0m[2025-01-22T19:50:04.592334] [SCALING] Decrementing count of first TM by 1.

[0m[2025-01-22T19:50:04.592365] =========================================================== Step 0 ===========================================================
[0m[2025-01-22T19:50:04.592386] [SCALING] Scaling on node : grid5000
[0m[2025-01-22T19:50:04.592450] [SCALING] Adding 1 replicas of l-2c taskmanager.
[0m[2025-01-22T19:50:04.598062] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:50:04.608088] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 1, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:50:04.617708] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 2 replica.
[0m[2025-01-22T19:50:09.694651] [SCALING] ************************************ Adding 2 replicas ************************************
[0m[2025-01-22T19:50:09.694720] [FLK_MGR] Running job.
[0m[2025-01-22T19:50:09.694726] [FLK_MGR] Rescaling job to 2.
[0m[2025-01-22T19:50:09.978631] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d b7a8d3aadfebd719ef423ba0f19e4361'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:50:14.033902] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-b7a8d3-ab5ce717c1f0
[0m[2025-01-22T19:50:33.373504] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-b7a8d3-ab5ce717c1f0 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:50:36.459665] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 2.
[0m[2025-01-22T19:50:36.459702] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 2
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 2531bf0876551ed213cd3e1995c2a049

[0m[2025-01-22T19:50:36.459722] [FLK_MGR] Running job id: 2531bf0876551ed213cd3e1995c2a049
[0m[2025-01-22T19:50:36.459729] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:50:36.466598] [FLK_MGR] Job plan response: {"plan":{"jid":"2531bf0876551ed213cd3e1995c2a049","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":2,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:50:36.466737] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:50:36.734519] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:50:38.129520] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:50:36 : 2531bf0876551ed213cd3e1995c2a049 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:50:38.129575] [FLK_MGR] Running jobs: ['2531bf0876551ed213cd3e1995c2a049']
[0m[2025-01-22T19:50:38.129582] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:50:38.135504] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:54:38.158855] [SCALING] Adding 2 replicas of l-2c taskmanager.
[0m[2025-01-22T19:54:38.166326] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:54:38.177435] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 2, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:54:38.186491] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 4 replica.
[0m[2025-01-22T19:54:43.205479] [SCALING] ************************************ Adding 4 replicas ************************************
[0m[2025-01-22T19:54:43.205504] [FLK_MGR] Running job.
[0m[2025-01-22T19:54:43.205508] [FLK_MGR] Rescaling job to 4.
[0m[2025-01-22T19:54:43.561845] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 2531bf0876551ed213cd3e1995c2a049'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:54:51.582814] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-2531bf-506051c8b21f
[0m[2025-01-22T19:55:10.863965] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-2531bf-506051c8b21f -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:55:13.700134] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 4.
[0m[2025-01-22T19:55:13.700171] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 4
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 76de3fdb628a9f675ababe06a3875553

[0m[2025-01-22T19:55:13.700191] [FLK_MGR] Running job id: 76de3fdb628a9f675ababe06a3875553
[0m[2025-01-22T19:55:13.700196] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:55:13.709159] [FLK_MGR] Job plan response: {"plan":{"jid":"76de3fdb628a9f675ababe06a3875553","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":4,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:55:13.709298] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:55:14.042803] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:55:15.448801] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:55:13 : 76de3fdb628a9f675ababe06a3875553 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:55:15.448855] [FLK_MGR] Running jobs: ['76de3fdb628a9f675ababe06a3875553']
[0m[2025-01-22T19:55:15.448862] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:55:15.458603] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T19:59:15.482743] [SCALING] Adding 4 replicas of l-2c taskmanager.
[0m[2025-01-22T19:59:15.487879] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T19:59:15.498084] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 4, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T19:59:15.506739] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 8 replica.
[0m[2025-01-22T19:59:20.526373] [SCALING] ************************************ Adding 8 replicas ************************************
[0m[2025-01-22T19:59:20.526397] [FLK_MGR] Running job.
[0m[2025-01-22T19:59:20.526402] [FLK_MGR] Rescaling job to 8.
[0m[2025-01-22T19:59:20.874411] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 76de3fdb628a9f675ababe06a3875553'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:59:26.935864] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-76de3f-e8008839c020
[0m[2025-01-22T19:59:46.217729] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-76de3f-e8008839c020 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:59:49.008456] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 8.
[0m[2025-01-22T19:59:49.008492] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 8
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 0fe2d8c9046f576c7ad65be94ebad526

[0m[2025-01-22T19:59:49.008512] [FLK_MGR] Running job id: 0fe2d8c9046f576c7ad65be94ebad526
[0m[2025-01-22T19:59:49.008518] [FLK_MGR] Getting job info.
[0m[2025-01-22T19:59:49.015459] [FLK_MGR] Job plan response: {"plan":{"jid":"0fe2d8c9046f576c7ad65be94ebad526","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":8,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T19:59:49.015596] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T19:59:49.384186] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T19:59:50.790219] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 19:59:48 : 0fe2d8c9046f576c7ad65be94ebad526 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T19:59:50.790271] [FLK_MGR] Running jobs: ['0fe2d8c9046f576c7ad65be94ebad526']
[0m[2025-01-22T19:59:50.790277] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T19:59:50.796422] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:03:50.819995] [SCALING] Adding 8 replicas of l-2c taskmanager.
[0m[2025-01-22T20:03:50.826617] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:03:50.837903] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 8, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:03:50.847585] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 16 replica.
[0m[2025-01-22T20:03:55.866793] [SCALING] ************************************ Adding 16 replicas ************************************
[0m[2025-01-22T20:03:55.866821] [FLK_MGR] Running job.
[0m[2025-01-22T20:03:55.866826] [FLK_MGR] Rescaling job to 16.
[0m[2025-01-22T20:03:56.232691] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 0fe2d8c9046f576c7ad65be94ebad526'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T20:04:00.310368] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-0fe2d8-2eb0e9c7f2c6
[0m[2025-01-22T20:04:19.618509] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-0fe2d8-2eb0e9c7f2c6 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T20:04:22.426953] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 16.
[0m[2025-01-22T20:04:22.426993] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 16
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 7c4719bec2bdaafe590310800cdf5595

[0m[2025-01-22T20:04:22.427016] [FLK_MGR] Running job id: 7c4719bec2bdaafe590310800cdf5595
[0m[2025-01-22T20:04:22.427026] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:04:22.433766] [FLK_MGR] Job plan response: {"plan":{"jid":"7c4719bec2bdaafe590310800cdf5595","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":16,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:04:22.433900] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:04:22.800165] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T20:04:24.279163] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:04:22 : 7c4719bec2bdaafe590310800cdf5595 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:04:24.279220] [FLK_MGR] Running jobs: ['7c4719bec2bdaafe590310800cdf5595']
[0m[2025-01-22T20:04:24.279227] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:04:24.285609] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:08:24.310058] [SCALING] Adding 10 replicas of l-2c taskmanager.
[0m[2025-01-22T20:08:24.316263] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:08:24.326495] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 16, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:08:24.335585] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 26 replica.
[0m[2025-01-22T20:08:29.357842] [SCALING] ************************************ Adding 26 replicas ************************************
[0m[2025-01-22T20:08:29.357891] [FLK_MGR] Running job.
[0m[2025-01-22T20:08:29.357899] [FLK_MGR] Rescaling job to 26.
[0m[2025-01-22T20:08:29.757592] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 7c4719bec2bdaafe590310800cdf5595'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T20:08:33.826808] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-7c4719-12692282fe1d
[0m[2025-01-22T20:08:53.153821] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-7c4719-12692282fe1d -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T20:08:56.019614] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 26.
[0m[2025-01-22T20:08:56.019656] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 26
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 0089c665e4f4245778c1e4c585493896

[0m[2025-01-22T20:08:56.019679] [FLK_MGR] Running job id: 0089c665e4f4245778c1e4c585493896
[0m[2025-01-22T20:08:56.019690] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:08:56.028107] [FLK_MGR] Job plan response: {"plan":{"jid":"0089c665e4f4245778c1e4c585493896","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":26,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:08:56.028249] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:08:56.455200] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-lptjt
[0m[2025-01-22T20:08:57.968090] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:08:55 : 0089c665e4f4245778c1e4c585493896 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:08:57.968175] [FLK_MGR] Running jobs: ['0089c665e4f4245778c1e4c585493896']
[0m[2025-01-22T20:08:57.968192] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:08:57.975585] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:12:57.998065] [SCALING] Scaling step on node paradoxe-4.rennes.grid5000.fr finished. Marking node as full.
[0m[2025-01-22T20:13:03.010482] [SCALING] Scaling finished.
[0m[2025-01-22T20:13:03.010548] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T20:13:03.026662] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T20:13:03.044394] [STS_MGR] Resetting taskmanagers.
[0m[2025-01-22T20:13:03.063748] [STS_MGR] StatefulSet flink-taskmanager-l scaled to 0 replica.
[0m[2025-01-22T20:13:03.076321] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 0 replica.
[0m[2025-01-22T20:13:08.094456] [STS_MGR] StatefulSet flink-taskmanager-m scaled to 0 replica.
[0m[2025-01-22T20:13:08.105467] [STS_MGR] StatefulSet flink-taskmanager-s scaled to 0 replica.
[0m[2025-01-22T20:13:08.116574] [STS_MGR] StatefulSet flink-taskmanager-xl scaled to 0 replica.
[0m[2025-01-22T20:13:08.127613] [STS_MGR] StatefulSet flink-taskmanager-xxl scaled to 0 replica.
[0m[2025-01-22T20:13:08.149044] [POD_MGR] Pod flink-jobmanager-7d7c784b74-lptjt deleted
[0m[2025-01-22T20:13:10.041359] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T20:13:11.869592] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T20:13:11.869731] Reloading playbook: application/kafka
[0m[2025-01-22T20:13:17.809598] Playbook /app/playbooks/application/kafka.yaml with tag delete executed successfully.
[0m[2025-01-22T20:14:03.712147] Playbook /app/playbooks/application/kafka.yaml with tag create executed successfully.
[0m[2025-01-22T20:14:03.712410] [EXPERIMENT] Run 2 completed. Start: 1737575149, End: 1737576843
[0m[2025-01-22T20:14:03.712421] [EXPERIMENT] Sleeping for 10 seconds before next run.
[0m[2025-01-22T20:14:13.713394] [EXPERIMENT] =================================== Starting run 3 ===================================
[0m[2025-01-22T20:14:15.574924] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T20:14:17.441647] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T20:14:17.441708] [SCALING] Setting up experiment.


[0m[2025-01-22T20:14:17.441717] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T20:14:17.446602] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T20:14:17.465475] [SCALING] First node: paradoxe-4.rennes.grid5000.fr

[0m[2025-01-22T20:14:17.482670] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:14:17.492031] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 1 replica.
[0m[2025-01-22T20:14:22.501568] [FLK_MGR] Running job.
[0m[2025-01-22T20:14:22.827382] [POD_MGR] Running command ['/bin/sh', '-c', 'flink run -d -j /tmp/jobs/myjoin-transscale-all.jar'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:14:26.850284] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Job has been submitted with JobID 791453c0d2717e8b97e469988c9b14d4

[0m[2025-01-22T20:14:26.850331] [FLK_MGR] Running job id: 791453c0d2717e8b97e469988c9b14d4
[0m[2025-01-22T20:14:26.850338] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:14:26.867497] [FLK_MGR] Job plan response: {"plan":{"jid":"791453c0d2717e8b97e469988c9b14d4","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"FORWARD","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":1,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:14:26.867646] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:14:27.138153] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:14:28.543621] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:14:25 : 791453c0d2717e8b97e469988c9b14d4 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:14:28.543678] [FLK_MGR] Running jobs: ['791453c0d2717e8b97e469988c9b14d4']
[0m[2025-01-22T20:14:28.543684] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:14:28.543690] [SCALING] First iteration after setup, just waiting...
[0m[2025-01-22T20:18:28.566422] [SCALING] Scaling started.
[0m[2025-01-22T20:18:28.566506] [SCALING] Decrementing count of first TM by 1.

[0m[2025-01-22T20:18:28.566538] =========================================================== Step 0 ===========================================================
[0m[2025-01-22T20:18:28.566558] [SCALING] Scaling on node : grid5000
[0m[2025-01-22T20:18:28.566607] [SCALING] Adding 1 replicas of l-2c taskmanager.
[0m[2025-01-22T20:18:28.571914] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:18:28.581803] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 1, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:18:28.590819] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 2 replica.
[0m[2025-01-22T20:18:33.611066] [SCALING] ************************************ Adding 2 replicas ************************************
[0m[2025-01-22T20:18:33.611095] [FLK_MGR] Running job.
[0m[2025-01-22T20:18:33.611100] [FLK_MGR] Rescaling job to 2.
[0m[2025-01-22T20:18:33.928382] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 791453c0d2717e8b97e469988c9b14d4'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:18:37.991422] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-791453-94c5e49148a2
[0m[2025-01-22T20:18:57.311718] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-791453-94c5e49148a2 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:19:00.431649] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 2.
[0m[2025-01-22T20:19:00.431684] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 2
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 0a5aa7ae0c72a5e326a9bd92979c7f48

[0m[2025-01-22T20:19:00.431702] [FLK_MGR] Running job id: 0a5aa7ae0c72a5e326a9bd92979c7f48
[0m[2025-01-22T20:19:00.431708] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:19:00.440998] [FLK_MGR] Job plan response: {"plan":{"jid":"0a5aa7ae0c72a5e326a9bd92979c7f48","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":2,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:19:00.441143] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:19:00.709206] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:19:02.101014] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:19:00 : 0a5aa7ae0c72a5e326a9bd92979c7f48 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:19:02.101065] [FLK_MGR] Running jobs: ['0a5aa7ae0c72a5e326a9bd92979c7f48']
[0m[2025-01-22T20:19:02.101071] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:19:02.109326] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:23:02.134019] [SCALING] Adding 2 replicas of l-2c taskmanager.
[0m[2025-01-22T20:23:02.139356] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:23:02.149556] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 2, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:23:02.157889] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 4 replica.
[0m[2025-01-22T20:23:07.176526] [SCALING] ************************************ Adding 4 replicas ************************************
[0m[2025-01-22T20:23:07.176552] [FLK_MGR] Running job.
[0m[2025-01-22T20:23:07.176557] [FLK_MGR] Rescaling job to 4.
[0m[2025-01-22T20:23:07.502924] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 0a5aa7ae0c72a5e326a9bd92979c7f48'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:23:17.581987] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-0a5aa7-4079f99d0e5b
[0m[2025-01-22T20:23:36.856321] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-0a5aa7-4079f99d0e5b -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:23:39.815121] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 4.
[0m[2025-01-22T20:23:39.815156] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 4
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 4ee9d5e53b302659a96b99c04637f896

[0m[2025-01-22T20:23:39.815171] [FLK_MGR] Running job id: 4ee9d5e53b302659a96b99c04637f896
[0m[2025-01-22T20:23:39.815176] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:23:39.822326] [FLK_MGR] Job plan response: {"plan":{"jid":"4ee9d5e53b302659a96b99c04637f896","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":4,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:23:39.822492] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:23:40.134173] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:23:41.553331] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:23:39 : 4ee9d5e53b302659a96b99c04637f896 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:23:41.553385] [FLK_MGR] Running jobs: ['4ee9d5e53b302659a96b99c04637f896']
[0m[2025-01-22T20:23:41.553392] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:23:41.559713] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:27:41.583536] [SCALING] Adding 4 replicas of l-2c taskmanager.
[0m[2025-01-22T20:27:41.588531] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:27:41.598154] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 4, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:27:41.606544] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 8 replica.
[0m[2025-01-22T20:27:46.623511] [SCALING] ************************************ Adding 8 replicas ************************************
[0m[2025-01-22T20:27:46.623537] [FLK_MGR] Running job.
[0m[2025-01-22T20:27:46.623542] [FLK_MGR] Rescaling job to 8.
[0m[2025-01-22T20:27:46.956788] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 4ee9d5e53b302659a96b99c04637f896'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:27:53.016665] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-4ee9d5-804d080e56a1
[0m[2025-01-22T20:28:12.301677] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-4ee9d5-804d080e56a1 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:28:15.131889] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 8.
[0m[2025-01-22T20:28:15.131927] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 8
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 2a677ca52e15615ccedbd700c3716b33

[0m[2025-01-22T20:28:15.131958] [FLK_MGR] Running job id: 2a677ca52e15615ccedbd700c3716b33
[0m[2025-01-22T20:28:15.131966] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:28:15.139853] [FLK_MGR] Job plan response: {"plan":{"jid":"2a677ca52e15615ccedbd700c3716b33","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":8,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:28:15.140001] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:28:15.516912] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:28:16.978488] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:28:14 : 2a677ca52e15615ccedbd700c3716b33 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:28:16.978545] [FLK_MGR] Running jobs: ['2a677ca52e15615ccedbd700c3716b33']
[0m[2025-01-22T20:28:16.978553] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:28:16.984505] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:32:17.007364] [SCALING] Adding 8 replicas of l-2c taskmanager.
[0m[2025-01-22T20:32:17.012947] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:32:17.023010] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 8, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:32:17.032181] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 16 replica.
[0m[2025-01-22T20:32:22.050387] [SCALING] ************************************ Adding 16 replicas ************************************
[0m[2025-01-22T20:32:22.050419] [FLK_MGR] Running job.
[0m[2025-01-22T20:32:22.050425] [FLK_MGR] Rescaling job to 16.
[0m[2025-01-22T20:32:22.413872] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 2a677ca52e15615ccedbd700c3716b33'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:32:26.450411] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-2a677c-01c0e8a00772
[0m[2025-01-22T20:32:45.754518] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-2a677c-01c0e8a00772 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:32:48.602231] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 16.
[0m[2025-01-22T20:32:48.602264] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 16
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 17cece48dcdffd99c467e2574b05d153

[0m[2025-01-22T20:32:48.602280] [FLK_MGR] Running job id: 17cece48dcdffd99c467e2574b05d153
[0m[2025-01-22T20:32:48.602286] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:32:48.609521] [FLK_MGR] Job plan response: {"plan":{"jid":"17cece48dcdffd99c467e2574b05d153","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":16,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:32:48.609732] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:32:48.949354] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:32:50.411037] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:32:48 : 17cece48dcdffd99c467e2574b05d153 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:32:50.411091] [FLK_MGR] Running jobs: ['17cece48dcdffd99c467e2574b05d153']
[0m[2025-01-22T20:32:50.411098] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:32:50.418621] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:36:50.442548] [SCALING] Adding 10 replicas of l-2c taskmanager.
[0m[2025-01-22T20:36:50.448299] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:36:50.459012] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 16, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:36:50.469546] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 26 replica.
[0m[2025-01-22T20:36:55.487930] [SCALING] ************************************ Adding 26 replicas ************************************
[0m[2025-01-22T20:36:55.487967] [FLK_MGR] Running job.
[0m[2025-01-22T20:36:55.487972] [FLK_MGR] Rescaling job to 26.
[0m[2025-01-22T20:36:55.865973] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 17cece48dcdffd99c467e2574b05d153'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:36:59.862769] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-17cece-1a639819d01f
[0m[2025-01-22T20:37:19.189916] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-17cece-1a639819d01f -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:37:22.067388] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 26.
[0m[2025-01-22T20:37:22.067432] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 26
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 10a803380edf864ecf0a8bb99881e918

[0m[2025-01-22T20:37:22.067452] [FLK_MGR] Running job id: 10a803380edf864ecf0a8bb99881e918
[0m[2025-01-22T20:37:22.067458] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:37:22.075669] [FLK_MGR] Job plan response: {"plan":{"jid":"10a803380edf864ecf0a8bb99881e918","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":26,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:37:22.075803] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:37:22.503318] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-pvtkz
[0m[2025-01-22T20:37:24.012756] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:37:21 : 10a803380edf864ecf0a8bb99881e918 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:37:24.012813] [FLK_MGR] Running jobs: ['10a803380edf864ecf0a8bb99881e918']
[0m[2025-01-22T20:37:24.012821] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:37:24.019762] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:41:24.043632] [SCALING] Scaling step on node paradoxe-4.rennes.grid5000.fr finished. Marking node as full.
[0m[2025-01-22T20:41:29.058721] [SCALING] Scaling finished.
[0m[2025-01-22T20:41:29.058777] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T20:41:29.074456] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T20:41:29.090136] [STS_MGR] Resetting taskmanagers.
[0m[2025-01-22T20:41:29.110077] [STS_MGR] StatefulSet flink-taskmanager-l scaled to 0 replica.
[0m[2025-01-22T20:41:29.123910] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 0 replica.
[0m[2025-01-22T20:41:34.141213] [STS_MGR] StatefulSet flink-taskmanager-m scaled to 0 replica.
[0m[2025-01-22T20:41:34.152238] [STS_MGR] StatefulSet flink-taskmanager-s scaled to 0 replica.
[0m[2025-01-22T20:41:34.163647] [STS_MGR] StatefulSet flink-taskmanager-xl scaled to 0 replica.
[0m[2025-01-22T20:41:34.175766] [STS_MGR] StatefulSet flink-taskmanager-xxl scaled to 0 replica.
[0m[2025-01-22T20:41:34.196243] [POD_MGR] Pod flink-jobmanager-7d7c784b74-pvtkz deleted
[0m[2025-01-22T20:41:36.098640] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T20:41:37.990065] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T20:41:37.990160] Reloading playbook: application/kafka
[0m[2025-01-22T20:41:43.934137] Playbook /app/playbooks/application/kafka.yaml with tag delete executed successfully.
[0m[2025-01-22T20:42:29.825711] Playbook /app/playbooks/application/kafka.yaml with tag create executed successfully.
[0m[2025-01-22T20:42:29.825861] [EXPERIMENT] Run 3 completed. Start: 1737576853, End: 1737578549
[0m[2025-01-22T20:42:29.825867] [EXPERIMENT] Sleeping for 10 seconds before next run.
[0m[2025-01-22T20:42:39.826874] [EXPERIMENT] =================================== Starting run 4 ===================================
[0m[2025-01-22T20:42:41.688257] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T20:42:43.527078] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T20:42:43.527141] [SCALING] Setting up experiment.


[0m[2025-01-22T20:42:43.527150] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T20:42:43.531548] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T20:42:43.544880] [SCALING] First node: paradoxe-4.rennes.grid5000.fr

[0m[2025-01-22T20:42:43.558947] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:42:43.568572] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 1 replica.
[0m[2025-01-22T20:42:48.577129] [FLK_MGR] Running job.
[0m[2025-01-22T20:42:48.899455] [POD_MGR] Running command ['/bin/sh', '-c', 'flink run -d -j /tmp/jobs/myjoin-transscale-all.jar'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:42:52.900096] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Job has been submitted with JobID abcd1b2c3c0e46452d0304cc01494243

[0m[2025-01-22T20:42:52.900138] [FLK_MGR] Running job id: abcd1b2c3c0e46452d0304cc01494243
[0m[2025-01-22T20:42:52.900144] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:42:52.917991] [FLK_MGR] Job plan response: {"plan":{"jid":"abcd1b2c3c0e46452d0304cc01494243","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"FORWARD","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":1,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:42:52.918126] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:42:53.214685] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:42:54.617197] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:42:51 : abcd1b2c3c0e46452d0304cc01494243 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:42:54.617248] [FLK_MGR] Running jobs: ['abcd1b2c3c0e46452d0304cc01494243']
[0m[2025-01-22T20:42:54.617254] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:42:54.617260] [SCALING] First iteration after setup, just waiting...
[0m[2025-01-22T20:46:54.640620] [SCALING] Scaling started.
[0m[2025-01-22T20:46:54.640707] [SCALING] Decrementing count of first TM by 1.

[0m[2025-01-22T20:46:54.640740] =========================================================== Step 0 ===========================================================
[0m[2025-01-22T20:46:54.640758] [SCALING] Scaling on node : grid5000
[0m[2025-01-22T20:46:54.640834] [SCALING] Adding 1 replicas of l-2c taskmanager.
[0m[2025-01-22T20:46:54.646719] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:46:54.657936] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 1, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:46:54.668345] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 2 replica.
[0m[2025-01-22T20:46:59.687266] [SCALING] ************************************ Adding 2 replicas ************************************
[0m[2025-01-22T20:46:59.687293] [FLK_MGR] Running job.
[0m[2025-01-22T20:46:59.687298] [FLK_MGR] Rescaling job to 2.
[0m[2025-01-22T20:47:00.005550] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d abcd1b2c3c0e46452d0304cc01494243'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:47:08.098688] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-abcd1b-f00f3c013069
[0m[2025-01-22T20:47:27.427794] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-abcd1b-f00f3c013069 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:47:30.505014] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 2.
[0m[2025-01-22T20:47:30.505053] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 2
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 087d73598224c05d0f2f4f474e0ff6e9

[0m[2025-01-22T20:47:30.505074] [FLK_MGR] Running job id: 087d73598224c05d0f2f4f474e0ff6e9
[0m[2025-01-22T20:47:30.505080] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:47:30.510601] [FLK_MGR] Job plan response: {"plan":{"jid":"087d73598224c05d0f2f4f474e0ff6e9","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":2,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:47:30.510753] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:47:30.779671] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:47:32.195377] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:47:30 : 087d73598224c05d0f2f4f474e0ff6e9 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:47:32.195428] [FLK_MGR] Running jobs: ['087d73598224c05d0f2f4f474e0ff6e9']
[0m[2025-01-22T20:47:32.195435] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:47:32.201868] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:51:32.225090] [SCALING] Adding 2 replicas of l-2c taskmanager.
[0m[2025-01-22T20:51:32.230646] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:51:32.240575] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 2, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:51:32.250405] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 4 replica.
[0m[2025-01-22T20:51:37.269526] [SCALING] ************************************ Adding 4 replicas ************************************
[0m[2025-01-22T20:51:37.269553] [FLK_MGR] Running job.
[0m[2025-01-22T20:51:37.269558] [FLK_MGR] Rescaling job to 4.
[0m[2025-01-22T20:51:37.596293] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 087d73598224c05d0f2f4f474e0ff6e9'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:51:47.681352] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-087d73-902a01b7d4ae
[0m[2025-01-22T20:52:06.953240] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-087d73-902a01b7d4ae -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:52:09.893984] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 4.
[0m[2025-01-22T20:52:09.894021] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 4
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID a1fd47a33d793c052132f94c773542a7

[0m[2025-01-22T20:52:09.894039] [FLK_MGR] Running job id: a1fd47a33d793c052132f94c773542a7
[0m[2025-01-22T20:52:09.894044] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:52:09.900046] [FLK_MGR] Job plan response: {"plan":{"jid":"a1fd47a33d793c052132f94c773542a7","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":4,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:52:09.900177] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:52:10.213069] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:52:11.651353] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:52:09 : a1fd47a33d793c052132f94c773542a7 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:52:11.651409] [FLK_MGR] Running jobs: ['a1fd47a33d793c052132f94c773542a7']
[0m[2025-01-22T20:52:11.651415] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:52:11.657600] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T20:56:11.681306] [SCALING] Adding 4 replicas of l-2c taskmanager.
[0m[2025-01-22T20:56:11.686295] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T20:56:11.697475] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 4, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T20:56:11.707511] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 8 replica.
[0m[2025-01-22T20:56:16.725592] [SCALING] ************************************ Adding 8 replicas ************************************
[0m[2025-01-22T20:56:16.725622] [FLK_MGR] Running job.
[0m[2025-01-22T20:56:16.725627] [FLK_MGR] Rescaling job to 8.
[0m[2025-01-22T20:56:17.063490] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d a1fd47a33d793c052132f94c773542a7'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:56:21.102255] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-a1fd47-4384e74268cf
[0m[2025-01-22T20:56:40.389418] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-a1fd47-4384e74268cf -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:56:43.236357] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 8.
[0m[2025-01-22T20:56:43.236398] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 8
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 521e68d7eb40eff6be8a21bf93d637c6

[0m[2025-01-22T20:56:43.236419] [FLK_MGR] Running job id: 521e68d7eb40eff6be8a21bf93d637c6
[0m[2025-01-22T20:56:43.236425] [FLK_MGR] Getting job info.
[0m[2025-01-22T20:56:43.243070] [FLK_MGR] Job plan response: {"plan":{"jid":"521e68d7eb40eff6be8a21bf93d637c6","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":8,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T20:56:43.243204] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T20:56:43.633282] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T20:56:45.057064] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 20:56:43 : 521e68d7eb40eff6be8a21bf93d637c6 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T20:56:45.057117] [FLK_MGR] Running jobs: ['521e68d7eb40eff6be8a21bf93d637c6']
[0m[2025-01-22T20:56:45.057124] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T20:56:45.063486] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:00:45.087685] [SCALING] Adding 8 replicas of l-2c taskmanager.
[0m[2025-01-22T21:00:45.092722] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:00:45.102407] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 8, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:00:45.110710] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 16 replica.
[0m[2025-01-22T21:00:50.129466] [SCALING] ************************************ Adding 16 replicas ************************************
[0m[2025-01-22T21:00:50.129496] [FLK_MGR] Running job.
[0m[2025-01-22T21:00:50.129502] [FLK_MGR] Rescaling job to 16.
[0m[2025-01-22T21:00:50.432427] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 521e68d7eb40eff6be8a21bf93d637c6'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T21:00:54.465527] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-521e68-4fef9de8c0f6
[0m[2025-01-22T21:01:13.824359] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-521e68-4fef9de8c0f6 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T21:01:16.564740] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 16.
[0m[2025-01-22T21:01:16.564774] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 16
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID aef0ecf9aeb772574521e6bd3272b85a

[0m[2025-01-22T21:01:16.564791] [FLK_MGR] Running job id: aef0ecf9aeb772574521e6bd3272b85a
[0m[2025-01-22T21:01:16.564797] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:01:16.570466] [FLK_MGR] Job plan response: {"plan":{"jid":"aef0ecf9aeb772574521e6bd3272b85a","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":16,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:01:16.570595] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:01:16.921700] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T21:01:18.362123] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:01:16 : aef0ecf9aeb772574521e6bd3272b85a : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:01:18.362177] [FLK_MGR] Running jobs: ['aef0ecf9aeb772574521e6bd3272b85a']
[0m[2025-01-22T21:01:18.362183] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:01:18.367872] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:05:18.390095] [SCALING] Adding 10 replicas of l-2c taskmanager.
[0m[2025-01-22T21:05:18.395055] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:05:18.404584] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 16, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:05:18.413230] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 26 replica.
[0m[2025-01-22T21:05:23.431708] [SCALING] ************************************ Adding 26 replicas ************************************
[0m[2025-01-22T21:05:23.431736] [FLK_MGR] Running job.
[0m[2025-01-22T21:05:23.431741] [FLK_MGR] Rescaling job to 26.
[0m[2025-01-22T21:05:23.813202] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d aef0ecf9aeb772574521e6bd3272b85a'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T21:05:27.853049] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-aef0ec-0eb1af136861
[0m[2025-01-22T21:05:47.181486] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-aef0ec-0eb1af136861 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T21:05:49.993669] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 26.
[0m[2025-01-22T21:05:49.993706] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 26
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID fc21cd077787e57a598f36e1586a8585

[0m[2025-01-22T21:05:49.993723] [FLK_MGR] Running job id: fc21cd077787e57a598f36e1586a8585
[0m[2025-01-22T21:05:49.993729] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:05:49.998842] [FLK_MGR] Job plan response: {"plan":{"jid":"fc21cd077787e57a598f36e1586a8585","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":26,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:05:49.999002] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:05:50.426921] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-cphzg
[0m[2025-01-22T21:05:51.977346] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:05:49 : fc21cd077787e57a598f36e1586a8585 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:05:51.977400] [FLK_MGR] Running jobs: ['fc21cd077787e57a598f36e1586a8585']
[0m[2025-01-22T21:05:51.977406] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:05:51.983389] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:09:52.005695] [SCALING] Scaling step on node paradoxe-4.rennes.grid5000.fr finished. Marking node as full.
[0m[2025-01-22T21:09:57.016967] [SCALING] Scaling finished.
[0m[2025-01-22T21:09:57.017048] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T21:09:57.032896] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T21:09:57.048103] [STS_MGR] Resetting taskmanagers.
[0m[2025-01-22T21:09:57.066297] [STS_MGR] StatefulSet flink-taskmanager-l scaled to 0 replica.
[0m[2025-01-22T21:09:57.078282] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 0 replica.
[0m[2025-01-22T21:10:02.094029] [STS_MGR] StatefulSet flink-taskmanager-m scaled to 0 replica.
[0m[2025-01-22T21:10:02.106795] [STS_MGR] StatefulSet flink-taskmanager-s scaled to 0 replica.
[0m[2025-01-22T21:10:02.118195] [STS_MGR] StatefulSet flink-taskmanager-xl scaled to 0 replica.
[0m[2025-01-22T21:10:02.129614] [STS_MGR] StatefulSet flink-taskmanager-xxl scaled to 0 replica.
[0m[2025-01-22T21:10:02.149178] [POD_MGR] Pod flink-jobmanager-7d7c784b74-cphzg deleted
[0m[2025-01-22T21:10:04.073722] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T21:10:05.961971] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T21:10:05.962047] Reloading playbook: application/kafka
[0m[2025-01-22T21:10:11.886352] Playbook /app/playbooks/application/kafka.yaml with tag delete executed successfully.
[0m[2025-01-22T21:10:57.748763] Playbook /app/playbooks/application/kafka.yaml with tag create executed successfully.
[0m[2025-01-22T21:10:57.748928] [EXPERIMENT] Run 4 completed. Start: 1737578559, End: 1737580257
[0m[2025-01-22T21:10:57.748934] [EXPERIMENT] Sleeping for 10 seconds before next run.
[0m[2025-01-22T21:11:07.749991] [EXPERIMENT] =================================== Starting run 5 ===================================
[0m[2025-01-22T21:11:09.598783] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T21:11:11.448644] Playbook /app/playbooks/application/load_generators.yaml with tag create executed successfully.
[0m[2025-01-22T21:11:11.448712] [SCALING] Setting up experiment.


[0m[2025-01-22T21:11:11.448723] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T21:11:11.453429] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T21:11:11.489159] [SCALING] First node: paradoxe-4.rennes.grid5000.fr

[0m[2025-01-22T21:11:11.503015] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:11:11.512404] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 1 replica.
[0m[2025-01-22T21:11:16.520351] [FLK_MGR] Running job.
[0m[2025-01-22T21:11:16.844461] [POD_MGR] Running command ['/bin/sh', '-c', 'flink run -d -j /tmp/jobs/myjoin-transscale-all.jar'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:11:20.834438] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Job has been submitted with JobID c3fd638dcd6af756df91ac13c2d59871

[0m[2025-01-22T21:11:20.834482] [FLK_MGR] Running job id: c3fd638dcd6af756df91ac13c2d59871
[0m[2025-01-22T21:11:20.834489] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:11:20.850963] [FLK_MGR] Job plan response: {"plan":{"jid":"c3fd638dcd6af756df91ac13c2d59871","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"FORWARD","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":1,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:11:20.851096] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:11:21.115973] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:11:22.542245] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:11:19 : c3fd638dcd6af756df91ac13c2d59871 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:11:22.542296] [FLK_MGR] Running jobs: ['c3fd638dcd6af756df91ac13c2d59871']
[0m[2025-01-22T21:11:22.542303] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:11:22.542308] [SCALING] First iteration after setup, just waiting...
[0m[2025-01-22T21:15:22.566668] [SCALING] Scaling started.
[0m[2025-01-22T21:15:22.566761] [SCALING] Decrementing count of first TM by 1.

[0m[2025-01-22T21:15:22.566794] =========================================================== Step 0 ===========================================================
[0m[2025-01-22T21:15:22.566813] [SCALING] Scaling on node : grid5000
[0m[2025-01-22T21:15:22.566872] [SCALING] Adding 1 replicas of l-2c taskmanager.
[0m[2025-01-22T21:15:22.573067] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:15:22.583313] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 1, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:15:22.592194] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 2 replica.
[0m[2025-01-22T21:15:27.612404] [SCALING] ************************************ Adding 2 replicas ************************************
[0m[2025-01-22T21:15:27.612435] [FLK_MGR] Running job.
[0m[2025-01-22T21:15:27.612440] [FLK_MGR] Rescaling job to 2.
[0m[2025-01-22T21:15:27.930412] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d c3fd638dcd6af756df91ac13c2d59871'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:15:31.968386] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-c3fd63-65e9299465bb
[0m[2025-01-22T21:15:51.254012] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-c3fd63-65e9299465bb -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:15:54.318305] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 2.
[0m[2025-01-22T21:15:54.318345] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:2;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 2
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID bd5cd8ec65e3f854c0abe992cff64702

[0m[2025-01-22T21:15:54.318504] [FLK_MGR] Running job id: bd5cd8ec65e3f854c0abe992cff64702
[0m[2025-01-22T21:15:54.318543] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:15:54.324939] [FLK_MGR] Job plan response: {"plan":{"jid":"bd5cd8ec65e3f854c0abe992cff64702","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":2,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:15:54.325092] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:15:54.638516] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:15:56.055398] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:15:54 : bd5cd8ec65e3f854c0abe992cff64702 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:15:56.055449] [FLK_MGR] Running jobs: ['bd5cd8ec65e3f854c0abe992cff64702']
[0m[2025-01-22T21:15:56.055456] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:15:56.063176] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:19:56.087551] [SCALING] Adding 2 replicas of l-2c taskmanager.
[0m[2025-01-22T21:19:56.094208] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:19:56.104880] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 2, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:19:56.114911] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 4 replica.
[0m[2025-01-22T21:20:01.134481] [SCALING] ************************************ Adding 4 replicas ************************************
[0m[2025-01-22T21:20:01.134509] [FLK_MGR] Running job.
[0m[2025-01-22T21:20:01.134514] [FLK_MGR] Rescaling job to 4.
[0m[2025-01-22T21:20:01.487469] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d bd5cd8ec65e3f854c0abe992cff64702'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:20:09.545839] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-bd5cd8-6a7e8b7e7e56
[0m[2025-01-22T21:20:28.820515] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-bd5cd8-6a7e8b7e7e56 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:20:31.765176] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 4.
[0m[2025-01-22T21:20:31.765228] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:4;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 4
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 8fd2bf014233d5e95e757f6008dc49b8

[0m[2025-01-22T21:20:31.765423] [FLK_MGR] Running job id: 8fd2bf014233d5e95e757f6008dc49b8
[0m[2025-01-22T21:20:31.765510] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:20:31.771768] [FLK_MGR] Job plan response: {"plan":{"jid":"8fd2bf014233d5e95e757f6008dc49b8","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":4,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:20:31.771918] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:20:32.096550] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:20:33.569868] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:20:31 : 8fd2bf014233d5e95e757f6008dc49b8 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:20:33.569922] [FLK_MGR] Running jobs: ['8fd2bf014233d5e95e757f6008dc49b8']
[0m[2025-01-22T21:20:33.569929] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:20:33.576444] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:24:33.600010] [SCALING] Adding 4 replicas of l-2c taskmanager.
[0m[2025-01-22T21:24:33.605836] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:24:33.616494] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 4, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:24:33.626642] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 8 replica.
[0m[2025-01-22T21:24:38.645771] [SCALING] ************************************ Adding 8 replicas ************************************
[0m[2025-01-22T21:24:38.645795] [FLK_MGR] Running job.
[0m[2025-01-22T21:24:38.645800] [FLK_MGR] Rescaling job to 8.
[0m[2025-01-22T21:24:38.926207] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 8fd2bf014233d5e95e757f6008dc49b8'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:24:44.938099] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-8fd2bf-7420c207df8d
[0m[2025-01-22T21:25:04.270716] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-8fd2bf-7420c207df8d -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:25:07.171881] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 8.
[0m[2025-01-22T21:25:07.171917] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:8;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 8
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 5fb29d6666bf9733c4be248581f33bed

[0m[2025-01-22T21:25:07.171934] [FLK_MGR] Running job id: 5fb29d6666bf9733c4be248581f33bed
[0m[2025-01-22T21:25:07.171940] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:25:07.178216] [FLK_MGR] Job plan response: {"plan":{"jid":"5fb29d6666bf9733c4be248581f33bed","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":8,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:25:07.178346] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:25:07.524419] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:25:08.987990] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:25:07 : 5fb29d6666bf9733c4be248581f33bed : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:25:08.988044] [FLK_MGR] Running jobs: ['5fb29d6666bf9733c4be248581f33bed']
[0m[2025-01-22T21:25:08.988050] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:25:08.994714] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:29:09.016517] [SCALING] Adding 8 replicas of l-2c taskmanager.
[0m[2025-01-22T21:29:09.021821] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:29:09.031704] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 8, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:29:09.040112] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 16 replica.
[0m[2025-01-22T21:29:14.057820] [SCALING] ************************************ Adding 16 replicas ************************************
[0m[2025-01-22T21:29:14.057848] [FLK_MGR] Running job.
[0m[2025-01-22T21:29:14.057853] [FLK_MGR] Rescaling job to 16.
[0m[2025-01-22T21:29:14.354363] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d 5fb29d6666bf9733c4be248581f33bed'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:29:18.391608] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-5fb29d-829546e6060a
[0m[2025-01-22T21:29:37.743342] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-5fb29d-829546e6060a -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:29:40.516267] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 16.
[0m[2025-01-22T21:29:40.516306] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:16;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 16
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID d833db4d2ddc0e4d36a0335aba38e73f

[0m[2025-01-22T21:29:40.516323] [FLK_MGR] Running job id: d833db4d2ddc0e4d36a0335aba38e73f
[0m[2025-01-22T21:29:40.516328] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:29:40.522923] [FLK_MGR] Job plan response: {"plan":{"jid":"d833db4d2ddc0e4d36a0335aba38e73f","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":16,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:29:40.523085] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:29:40.942523] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:29:42.553970] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:29:40 : d833db4d2ddc0e4d36a0335aba38e73f : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:29:42.554028] [FLK_MGR] Running jobs: ['d833db4d2ddc0e4d36a0335aba38e73f']
[0m[2025-01-22T21:29:42.554034] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:29:42.562223] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:33:42.585724] [SCALING] Adding 10 replicas of l-2c taskmanager.
[0m[2025-01-22T21:33:42.592684] [SCALING] Statefulset name to scale : flink-taskmanager-l-2c
[0m[2025-01-22T21:33:42.603944] [SCALING] Current taskmanagers count: {'flink-taskmanager-l': 0, 'flink-taskmanager-l-2c': 16, 'flink-taskmanager-m': 0, 'flink-taskmanager-s': 0, 'flink-taskmanager-xl': 0, 'flink-taskmanager-xxl': 0}
[0m[2025-01-22T21:33:42.613117] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 26 replica.
[0m[2025-01-22T21:33:47.631893] [SCALING] ************************************ Adding 26 replicas ************************************
[0m[2025-01-22T21:33:47.631917] [FLK_MGR] Running job.
[0m[2025-01-22T21:33:47.631922] [FLK_MGR] Rescaling job to 26.
[0m[2025-01-22T21:33:47.957315] [POD_MGR] Running command ['/bin/sh', '-c', 'flink stop -p -d d833db4d2ddc0e4d36a0335aba38e73f'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:33:51.962757] [FLK_MGR] Savepoint path: s3://flink-bucket/savepoints/savepoint-d833db-5446924682e7
[0m[2025-01-22T21:34:11.339063] [POD_MGR] Running command ['/bin/sh', '-c', "flink run -d -s s3://flink-bucket/savepoints/savepoint-d833db-5446924682e7 -j /tmp/jobs/myjoin-transscale-all.jar --parmap 'Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1'"] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:34:14.177834] [FLK_MGR] Operator TumblingEventTimeWindows rescaled to 26.
[0m[2025-01-22T21:34:14.177868] [FLK_MGR] Job run response: ERROR StatusLogger Reconfiguration failed: No configuration found for '37f8bb67' at 'null' in 'null'
ERROR StatusLogger Reconfiguration failed: No configuration found for '34e9fd99' at 'null' in 'null'
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator (file:/opt/flink/lib/flink-dist-1.20.0.jar) to field java.util.Collections$UnmodifiableMap.m
WARNING: Please consider reporting this to the maintainers of org.apache.flink.streaming.runtime.translators.DataStreamV2SinkTransformationTranslator
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
KAFKA_BOOTSTRAP_SERVERS: kafka-service.kafka.svc.cluster.local:9092
SCHEMA_REGISTRY_URL: http://schema-registry-service.kafka.svc.cluster.local:8081
KAFKA_INPUT_TOPIC1: input-topic1
KAFKA_INPUT_TOPIC2: input-topic2
JOB_WINDOW_SIZE: 1000
CHECKPOINTING: true
FIB_INPUT: 18
Starting JoinApplication.
Sink__Sink:1;Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks:26;Timestamps/Watermarks+-_Map:1;Source__Source1:1;Source__Source2:1
Sink__Sink --> 1
Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks --> 26
Timestamps/Watermarks+-_Map --> 1
Source__Source1 --> 1
Source__Source2 --> 1
Job has been submitted with JobID 1186b720592c69f4823ea6f3984f6600

[0m[2025-01-22T21:34:14.177889] [FLK_MGR] Running job id: 1186b720592c69f4823ea6f3984f6600
[0m[2025-01-22T21:34:14.177895] [FLK_MGR] Getting job info.
[0m[2025-01-22T21:34:14.182657] [FLK_MGR] Job plan response: {"plan":{"jid":"1186b720592c69f4823ea6f3984f6600","name":"myjoin-transscale-0.0.1","type":"STREAMING","nodes":[{"id":"41a95396e613c9f62f1da16142d5ddd2","parallelism":1,"operator":"","operator_strategy":"","description":"Sink: Sink<br/>","inputs":[{"num":0,"id":"32f0ffe0b6f0b990239bb81cec28b9d8","ship_strategy":"REBALANCE","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"32f0ffe0b6f0b990239bb81cec28b9d8","parallelism":26,"operator":"","operator_strategy":"","description":"Window(TumblingEventTimeWindows(1000), EventTimeTrigger, TimeEvictor, CoGroupWindowFunction)<br/>+- Timestamps/Watermarks<br/>","inputs":[{"num":0,"id":"31ec045e3401e87fc7879b43d8e8625d","ship_strategy":"HASH","exchange":"pipelined_bounded"},{"num":1,"id":"e926317ddf99720773e3c7f4f412c3d7","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"31ec045e3401e87fc7879b43d8e8625d","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"dca33db40b2f8f122636cd5297c0c511","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"dca33db40b2f8f122636cd5297c0c511","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source1<br/>","optimizer_properties":{}},{"id":"e926317ddf99720773e3c7f4f412c3d7","parallelism":1,"operator":"","operator_strategy":"","description":"Timestamps/Watermarks<br/>+- Map<br/>","inputs":[{"num":0,"id":"9c7327831b3b5b4ae2c580979f474a9c","ship_strategy":"HASH","exchange":"pipelined_bounded"}],"optimizer_properties":{}},{"id":"9c7327831b3b5b4ae2c580979f474a9c","parallelism":1,"operator":"","operator_strategy":"","description":"Source: Source2<br/>","optimizer_properties":{}}]}}
[0m[2025-01-22T21:34:14.182808] [FLK_MGR] Current operator names: dict_keys(['Sink__Sink', 'Window(TumblingEventTimeWindows(1000),_EventTimeTrigger,_TimeEvictor,_CoGroupWindowFunction)+-_Timestamps/Watermarks', 'Timestamps/Watermarks+-_Map', 'Source__Source1', 'Source__Source2'])
[0m[2025-01-22T21:34:14.564360] [POD_MGR] Running command ['/bin/sh', '-c', 'flink list -r 2>/dev/null'] on pod flink-jobmanager-7d7c784b74-v6x4w
[0m[2025-01-22T21:34:16.043571] [FLK_MGR] Running jobs: Waiting for response...
------------------ Running/Restarting Jobs -------------------
22.01.2025 21:34:14 : 1186b720592c69f4823ea6f3984f6600 : myjoin-transscale-0.0.1 (RUNNING)
--------------------------------------------------------------
[0m[2025-01-22T21:34:16.043626] [FLK_MGR] Running jobs: ['1186b720592c69f4823ea6f3984f6600']
[0m[2025-01-22T21:34:16.043632] [FLK_MGR] Total jobs cancelled: 0
[0m[2025-01-22T21:34:16.050112] [SCALING] Monitoring interval: for 240 seconds
[0m[2025-01-22T21:38:16.074152] [SCALING] Scaling step on node paradoxe-4.rennes.grid5000.fr finished. Marking node as full.
[0m[2025-01-22T21:38:21.086252] [SCALING] Scaling finished.
[0m[2025-01-22T21:38:21.086336] [NODE_MGR] Resetting scaling labels to unschedulable.
[0m[2025-01-22T21:38:21.103632] [NODE_MGR] Resetting state labels.
[0m[2025-01-22T21:38:21.117388] [STS_MGR] Resetting taskmanagers.
[0m[2025-01-22T21:38:21.135138] [STS_MGR] StatefulSet flink-taskmanager-l scaled to 0 replica.
[0m[2025-01-22T21:38:21.145987] [STS_MGR] StatefulSet flink-taskmanager-l-2c scaled to 0 replica.
[0m[2025-01-22T21:38:26.162883] [STS_MGR] StatefulSet flink-taskmanager-m scaled to 0 replica.
[0m[2025-01-22T21:38:26.173907] [STS_MGR] StatefulSet flink-taskmanager-s scaled to 0 replica.
[0m[2025-01-22T21:38:26.184656] [STS_MGR] StatefulSet flink-taskmanager-xl scaled to 0 replica.
[0m[2025-01-22T21:38:26.195373] [STS_MGR] StatefulSet flink-taskmanager-xxl scaled to 0 replica.
[0m[2025-01-22T21:38:26.212745] [POD_MGR] Pod flink-jobmanager-7d7c784b74-v6x4w deleted
[0m[2025-01-22T21:38:28.086148] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T21:38:29.965736] Playbook /app/playbooks/application/load_generators.yaml with tag delete executed successfully.
[0m[2025-01-22T21:38:29.965820] Reloading playbook: application/kafka
[0m[2025-01-22T21:38:35.875717] Playbook /app/playbooks/application/kafka.yaml with tag delete executed successfully.
[0m[2025-01-22T21:39:21.827584] Playbook /app/playbooks/application/kafka.yaml with tag create executed successfully.
[0m[2025-01-22T21:39:21.827713] [EXPERIMENT] Run 5 completed. Start: 1737580267, End: 1737581961
[0m[2025-01-22T21:39:21.827719] [EXPERIMENT] Sleeping for 10 seconds before next run.
[0m[2025-01-22T21:39:31.829153] [FSM] Run phase complete, transitioning to finishing.
[0m[2025-01-22T21:39:31.829419] [FSM] Finish phase started.
[0m[2025-01-22T21:39:31.829439] [FSM] State is States.FINISHING
[0m[2025-01-22T21:39:31.829810] FolderManager initialized with base path: /experiment-volume. Date: None
